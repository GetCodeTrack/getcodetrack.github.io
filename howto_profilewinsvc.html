<html>
<head>
    <title>CodeTrack</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="description" content="" />
    <meta name="keywords" content="Codetrack Profiling .NET performance c# vb.net" />
    <!--[if lte IE 8]><script src="js/html5shiv.js"></script><![endif]-->
    <script src="js/jquery.min.js"></script>
    <script src="js/skel.min.js"></script>
    <script src="js/skel-layers.min.js"></script>
    <script src="js/init.js"></script>
    <script src="js/mine.js"></script>
    <noscript>
        <link rel="stylesheet" href="css/skel.css" />
        <link rel="stylesheet" href="css/style.css" />
        <link rel="stylesheet" href="css/style-xlarge.css" />
    </noscript>
</head>
<body id="top">
    <div style="width: 60%; height: 80%; margin: auto;display: block">
       <h2>Profiling a windows service</h2>

<p>
This can be used to profile any .NET windows service. 
</p>

<p style="color:red">
<i class="fa fa-exclamation-triangle fa-1X" style="color:red"  aria-hidden="false"></i>
For profiling a windows service, it is necessary to run the profiler in elevated mode (you can do this by clicking on the elevation icon in the title bar, or run the profiler as admin).
In case of windows services it is usually  necessary to start the profiler with the same account as your service (using shift + right click in windows explorer and selecting 'Run as different user'). Alternatively you can also  let your service run with the account of your profiler instead.
</p>


<ol>
<li>Select the collect tab (on the left of the application)
</li>
<li>Select ‘Service’ and click the arrow on the right to go to the next step.<br/>
<br/>
<image src="./images/howto/profilewinsvc01.png">
</br>
</li>

<li>Now you can select the service you want to profile.</br>
The bittness and DotNet version should be selected automatically. Should this be incorrect, you can still change this manually.</br>
Now click the arrow on the right to go to the next step.<br/>
<br/>
<image src="./images/howto/profilewinsvc02.png">
</br>
</li>

<li>
Now it's time to decide upon your level of detail. Important to remember, is that the more detail you require, the higher the impact profiling will have on your performance.
If you just started investigating a problem, it might be a good idea to use the sampling option. Since this will be the most performant profiling mode.
From this information you can then start another session with much more detail, profiling only the code that causes the performance issue.
</br>For more information about the different profiling settings, read <a href="profilingmodes.html">Profiling Modes</a>.
<br/>
<br/>
<image src="./images/howto/profilewinsvc03.png">
</br>Now we are ready for the last step, click on the right arrow to continue.
</br>
</li>

<li>
In this last section you need to select the destination of the profiling data. (Make sure you select a location with enough
space if you profile with lots of detail).<br/>
If you want to als profile a child process (started by our own process), enable this before starting to profile.
</br>If you need to profile on a very slow machine,one with little RAM, or a production server, you can disable the processing of the data.
This allows you to do the number crunching offline on another machine.
</br>
<br/>
<image src="./images/howto/profilewinsvc04.png">
<br/>
If you want to start profiling immediately, make sure you click the record button, otherwise click the pause button and hit record from the moment
you want to start capturing data.<br/>
Now you are ready to start profiling. If you click the play button, your service will be started (or restarted if it was already running). 
<br/>
If you press the stop button Codetrack will stop your service (and restart it, if it was running before).
</br>
</li>

</ol>
    
    </div>
</body>


